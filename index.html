<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PARADOKS ALIBI - Game Detektif</title>
    <link href="https://fonts.googleapis.com/css2?family=Special+Elite&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --parchment: #f4e4bc;
            --parchment-dark: #d4c49a;
            --ink: #1a1a1a;
            --blood-red: #8b0000;
            --wood: #3d2914;
            --wood-light: #5c3d1e;
            --gold: #c9a227;
            --shadow: rgba(0, 0, 0, 0.7);
        }

        body {
            font-family: 'Special Elite', 'Courier New', monospace;
            background: linear-gradient(135deg, #1a0f0a 0%, #2d1810 50%, #1a0f0a 100%);
            min-height: 100vh;
            color: var(--ink);
            overflow-x: hidden;
        }

        /* Tekstur kayu overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 2px,
                    rgba(0,0,0,0.03) 2px,
                    rgba(0,0,0,0.03) 4px
                ),
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 50px,
                    rgba(139, 69, 19, 0.1) 50px,
                    rgba(139, 69, 19, 0.1) 51px
                );
            pointer-events: none;
            z-index: 1;
        }

        .game-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        /* Header */
        .game-header {
            text-align: center;
            padding: 30px;
            background: linear-gradient(180deg, rgba(0,0,0,0.8) 0%, transparent 100%);
            margin-bottom: 20px;
            border-bottom: 2px solid var(--gold);
        }

        .game-title {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            color: var(--gold);
            text-shadow: 
                3px 3px 6px rgba(0,0,0,0.8),
                0 0 30px rgba(201, 162, 39, 0.3);
            letter-spacing: 8px;
            margin-bottom: 10px;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { text-shadow: 3px 3px 6px rgba(0,0,0,0.8), 0 0 30px rgba(201, 162, 39, 0.3); }
            50% { text-shadow: 3px 3px 6px rgba(0,0,0,0.8), 0 0 50px rgba(201, 162, 39, 0.5); }
        }

        .subtitle {
            color: var(--parchment);
            font-size: 1rem;
            letter-spacing: 4px;
            opacity: 0.8;
        }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 40px;
            padding: 15px;
            background: rgba(0,0,0,0.6);
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid var(--wood-light);
            flex-wrap: wrap;
        }

        .stat {
            color: var(--parchment);
            font-size: 1.1rem;
        }

        .stat-value {
            color: var(--gold);
            font-weight: bold;
        }

        /* Area Narasi Kasus */
        .case-narration {
            background: 
                linear-gradient(135deg, var(--parchment) 0%, var(--parchment-dark) 100%);
            padding: 30px;
            border-radius: 5px;
            margin-bottom: 20px;
            box-shadow: 
                inset 0 0 50px rgba(0,0,0,0.1),
                0 10px 30px var(--shadow),
                0 0 0 3px var(--wood);
            position: relative;
            overflow: hidden;
        }

        .case-narration::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E");
            pointer-events: none;
        }

        .case-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--wood);
            flex-wrap: wrap;
            gap: 10px;
        }

        .case-number {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: var(--blood-red);
        }

        .case-stamp {
            background: var(--blood-red);
            color: white;
            padding: 5px 15px;
            border-radius: 3px;
            transform: rotate(-3deg);
            font-weight: bold;
        }

        .narration-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--ink);
            position: relative;
            z-index: 1;
        }

        .narration-text .highlight {
            background: linear-gradient(180deg, transparent 50%, rgba(201, 162, 39, 0.3) 50%);
            padding: 0 3px;
        }

        /* Area Konten Utama */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        /* Panel Bukti */
        .evidence-panel {
            background: var(--wood);
            padding: 25px;
            border-radius: 5px;
            box-shadow: 
                inset 0 2px 10px rgba(0,0,0,0.5),
                0 10px 30px var(--shadow);
            border: 3px solid var(--wood-light);
        }

        .panel-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: var(--gold);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--gold);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .panel-title::before {
            content: 'üîç';
        }

        .evidence-list {
            list-style: none;
        }

        .evidence-item {
            background: var(--parchment);
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 3px;
            box-shadow: 
                3px 3px 10px rgba(0,0,0,0.3),
                inset 0 0 20px rgba(0,0,0,0.05);
            transform: rotate(-1deg);
            transition: all 0.3s ease;
            opacity: 0;
            animation: fadeSlideIn 0.5s ease forwards;
            position: relative;
        }

        .evidence-item:nth-child(2) { animation-delay: 0.1s; transform: rotate(0.5deg); }
        .evidence-item:nth-child(3) { animation-delay: 0.2s; transform: rotate(-0.5deg); }
        .evidence-item:nth-child(4) { animation-delay: 0.3s; transform: rotate(1deg); }

        .evidence-item:hover {
            transform: rotate(0deg) scale(1.02);
            box-shadow: 5px 5px 15px rgba(0,0,0,0.4);
        }

        .evidence-item::before {
            content: 'üìå';
            position: absolute;
            top: -8px;
            right: 10px;
            font-size: 1.2rem;
        }

        .evidence-label {
            font-size: 0.8rem;
            color: var(--blood-red);
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .evidence-text {
            font-size: 1rem;
            color: var(--ink);
        }

        /* Panel Tersangka */
        .suspects-panel {
            display: flex;
            flex-direction: column;
        }

        .suspects-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: var(--gold);
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .suspects-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .suspect-card {
            background: linear-gradient(145deg, var(--parchment) 0%, var(--parchment-dark) 100%);
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 
                0 15px 35px var(--shadow),
                inset 0 0 30px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            opacity: 0;
            animation: fadeSlideUp 0.6s ease forwards;
            position: relative;
            border: 3px solid var(--wood);
        }

        .suspect-card:nth-child(1) { animation-delay: 0.2s; }
        .suspect-card:nth-child(2) { animation-delay: 0.4s; }
        .suspect-card:nth-child(3) { animation-delay: 0.6s; }

        .suspect-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 
                0 25px 50px var(--shadow),
                0 0 20px rgba(201, 162, 39, 0.3);
            border-color: var(--gold);
        }

        .suspect-card.accused {
            border-color: var(--blood-red);
            animation: shake 0.5s ease;
        }

        .suspect-card.correct {
            border-color: #2ecc71;
            box-shadow: 0 0 30px rgba(46, 204, 113, 0.5);
        }

        .suspect-card.wrong {
            border-color: var(--blood-red);
            box-shadow: 0 0 30px rgba(139, 0, 0, 0.5);
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .suspect-header {
            background: linear-gradient(135deg, var(--wood) 0%, var(--wood-light) 100%);
            padding: 15px;
            text-align: center;
        }

        .suspect-avatar {
            width: 70px;
            height: 70px;
            background: var(--parchment);
            border-radius: 50%;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 
                0 5px 15px rgba(0,0,0,0.3),
                inset 0 -3px 10px rgba(0,0,0,0.1);
            border: 3px solid var(--gold);
        }

        .suspect-name {
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
            color: var(--parchment);
            margin-bottom: 5px;
        }

        .suspect-role {
            font-size: 0.85rem;
            color: var(--gold);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .suspect-testimony {
            padding: 20px;
            min-height: 150px;
        }

        .testimony-label {
            font-size: 0.75rem;
            color: var(--blood-red);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .testimony-label::before {
            content: 'üí¨';
        }

        .testimony-text {
            font-size: 0.95rem;
            line-height: 1.6;
            color: var(--ink);
            font-style: italic;
        }

        .testimony-text::before,
        .testimony-text::after {
            content: '"';
            color: var(--blood-red);
            font-size: 1.2rem;
        }

        .accuse-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, var(--blood-red) 0%, #5c0000 100%);
            color: var(--parchment);
            border: none;
            font-family: 'Special Elite', monospace;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .accuse-btn:hover {
            background: linear-gradient(135deg, #a00000 0%, var(--blood-red) 100%);
            letter-spacing: 4px;
        }

        /* Panel Kontrol */
        .control-panel {
            background: rgba(0,0,0,0.7);
            padding: 25px;
            border-radius: 5px;
            text-align: center;
            border: 2px solid var(--wood-light);
        }

        .instruction-text {
            color: var(--parchment);
            font-size: 1.1rem;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 40px;
            font-family: 'Special Elite', monospace;
            font-size: 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--gold) 0%, #a07f1c 100%);
            color: var(--ink);
            box-shadow: 0 5px 20px rgba(201, 162, 39, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(201, 162, 39, 0.5);
        }

        .btn-secondary {
            background: transparent;
            color: var(--parchment);
            border: 2px solid var(--parchment);
        }

        .btn-secondary:hover {
            background: var(--parchment);
            color: var(--ink);
        }

        /* Modal Hasil */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.4s ease;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: linear-gradient(145deg, var(--parchment) 0%, var(--parchment-dark) 100%);
            padding: 40px;
            border-radius: 10px;
            max-width: 600px;
            text-align: center;
            box-shadow: 
                0 30px 60px rgba(0,0,0,0.5),
                0 0 100px rgba(201, 162, 39, 0.2);
            border: 5px solid var(--wood);
            transform: scale(0.8);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1);
        }

        .modal-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .modal-title {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--ink);
        }

        .modal-title.success {
            color: #27ae60;
        }

        .modal-title.failure {
            color: var(--blood-red);
        }

        .modal-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--ink);
            margin-bottom: 30px;
        }

        .modal-explanation {
            background: rgba(0,0,0,0.1);
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 25px;
            border-left: 4px solid var(--gold);
            text-align: left;
        }

        .modal-explanation-title {
            font-size: 0.9rem;
            color: var(--blood-red);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 10px;
        }

        /* Layar Mulai */
        .start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0505 0%, #1a0f0a 50%, #0a0505 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            flex-direction: column;
            padding: 20px;
        }

        .start-screen.hidden {
            display: none;
        }

        .start-title {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            color: var(--gold);
            text-shadow: 
                0 0 50px rgba(201, 162, 39, 0.5),
                0 0 100px rgba(201, 162, 39, 0.3);
            margin-bottom: 20px;
            letter-spacing: 8px;
            animation: titlePulse 2s ease-in-out infinite;
            text-align: center;
        }

        @keyframes titlePulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .start-subtitle {
            color: var(--parchment);
            font-size: 1.2rem;
            margin-bottom: 50px;
            opacity: 0.7;
            letter-spacing: 5px;
            text-align: center;
        }

        .start-description {
            color: var(--parchment);
            max-width: 600px;
            text-align: center;
            line-height: 1.8;
            margin-bottom: 40px;
            opacity: 0.8;
        }

        .start-btn {
            padding: 20px 60px;
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            background: transparent;
            color: var(--gold);
            border: 3px solid var(--gold);
            cursor: pointer;
            transition: all 0.4s ease;
            letter-spacing: 5px;
        }

        .start-btn:hover {
            background: var(--gold);
            color: var(--ink);
            box-shadow: 0 0 50px rgba(201, 162, 39, 0.5);
        }

        /* Animasi */
        @keyframes fadeSlideIn {
            from {
                opacity: 0;
                transform: translateX(-20px) rotate(-1deg);
            }
            to {
                opacity: 1;
                transform: translateX(0) rotate(-1deg);
            }
        }

        @keyframes fadeSlideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.8s ease forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Layar Game Over */
        .game-over-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            z-index: 3000;
            padding: 20px;
        }

        .game-over-screen.active {
            display: flex;
        }

        .game-over-title {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            color: var(--blood-red);
            margin-bottom: 30px;
            text-align: center;
        }

        .final-stats {
            color: var(--parchment);
            font-size: 1.3rem;
            margin-bottom: 40px;
            text-align: center;
            line-height: 2;
        }

        /* Responsif */
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .suspects-grid {
                grid-template-columns: 1fr;
            }
            
            .game-title, .start-title {
                font-size: 2rem;
                letter-spacing: 4px;
            }

            .stats-bar {
                gap: 15px;
            }

            .stat {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 600px) {
            .game-title, .start-title {
                font-size: 1.5rem;
            }

            .case-narration, .evidence-panel, .control-panel {
                padding: 15px;
            }

            .modal-content {
                padding: 20px;
            }

            .start-btn {
                padding: 15px 30px;
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Layar Mulai -->
    <div class="start-screen" id="startScreen">
        <h1 class="start-title">PARADOKS ALIBI</h1>
        <p class="start-subtitle">PERMAINAN DETEKTIF LOGIKA</p>
        <p class="start-description">
            Setiap pembunuh membuat satu kesalahan fatal ‚Äî sebuah kontradiksi dalam alibi mereka. 
            Periksa bukti-bukti, baca kesaksian para tersangka, dan temukan kebohongan yang tidak cocok dengan fakta. 
            Reputasimu sebagai detektif bergantung pada kejelianmu dalam memperhatikan detail.
        </p>
        <button class="start-btn" onclick="mulaiPermainan()">MULAI INVESTIGASI</button>
    </div>

    <!-- Layar Game Over -->
    <div class="game-over-screen" id="gameOverScreen">
        <h1 class="game-over-title">KASUS DITUTUP</h1>
        <div class="final-stats" id="finalStats"></div>
        <button class="btn btn-primary" onclick="mulaiUlang()">INVESTIGASI BARU</button>
    </div>

    <!-- Modal Hasil -->
    <div class="modal-overlay" id="resultModal">
        <div class="modal-content">
            <div class="modal-icon" id="modalIcon">üîç</div>
            <h2 class="modal-title" id="modalTitle">Hasil</h2>
            <div class="modal-explanation" id="modalExplanation">
                <div class="modal-explanation-title">Penalaran Detektif:</div>
                <p id="explanationText"></p>
            </div>
            <p class="modal-text" id="modalText"></p>
            <button class="btn btn-primary" id="modalBtn" onclick="tutupModal()">Lanjutkan</button>
        </div>
    </div>

    <!-- Container Game Utama -->
    <div class="game-container" id="gameContainer" style="display: none;">
        <!-- Header -->
        <header class="game-header">
            <h1 class="game-title">PARADOKS ALIBI</h1>
            <p class="subtitle">TEMUKAN KONTRADIKSINYA</p>
        </header>

        <!-- Bar Statistik -->
        <div class="stats-bar">
            <div class="stat">
                KASUS: <span class="stat-value" id="caseNumber">1</span>
            </div>
            <div class="stat">
                REPUTASI: <span class="stat-value" id="reputation">100</span>
            </div>
            <div class="stat">
                KASUS TERPECAHKAN: <span class="stat-value" id="casesSolved">0</span>
            </div>
        </div>

        <!-- Narasi Kasus -->
        <section class="case-narration" id="caseNarration">
            <div class="case-header">
                <span class="case-number" id="caseTitle">KASUS #001</span>
                <span class="case-stamp">BELUM TERPECAHKAN</span>
            </div>
            <div class="narration-text" id="narrationText">
                Memuat kasus...
            </div>
        </section>

        <!-- Konten Utama -->
        <div class="main-content">
            <!-- Panel Bukti -->
            <aside class="evidence-panel">
                <h2 class="panel-title">Bukti-Bukti</h2>
                <ul class="evidence-list" id="evidenceList">
                    <!-- Item bukti akan di-generate di sini -->
                </ul>
            </aside>

            <!-- Panel Tersangka -->
            <main class="suspects-panel">
                <h2 class="suspects-title">‚Äî TERSANGKA ‚Äî</h2>
                <div class="suspects-grid" id="suspectsGrid">
                    <!-- Kartu tersangka akan di-generate di sini -->
                </div>
            </main>
        </div>

        <!-- Panel Kontrol -->
        <div class="control-panel">
            <p class="instruction-text">
                üîç Periksa bukti dengan teliti. Satu alibi tersangka bertentangan dengan fakta.
            </p>
            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="lewatiKasus()">Lewati Kasus (-20 Rep)</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== DATA PERMAINAN ====================
        
        // Template Skenario dengan Logika Kontradiksi
        const TEMPLATE_KONTRADIKSI = [
            {
                id: 'hujan_deras',
                fakta: 'Malam itu hujan deras disertai badai petir.',
                faktaPendek: 'hujan deras dan badai petir',
                setBukti: [
                    { label: 'Laporan Cuaca', text: 'Peringatan badai petir dikeluarkan pukul 20.00. Hujan deras tercatat hingga tengah malam.' },
                    { label: 'TKP', text: 'Jejak kaki berlumpur ditemukan menuju pintu belakang. Genangan air di mana-mana di luar.' },
                    { label: 'Bukti Fisik', text: 'Payung korban ditemukan rusak di dekat pintu masuk.' }
                ],
                alibiTakBersalah: [
                    'Saya di dalam rumah membaca buku sepanjang malam. Petirnya sangat keras, saya hampir tidak bisa konsentrasi.',
                    'Saya tetap di kamar karena badai. Saya dengar hujan menghantam jendela sampai saya tertidur.',
                    'Saya di dapur menyiapkan makan malam. Listrik berkedip beberapa kali karena badai.',
                    'Saya menonton badai dari jendela perpustakaan. Cukup menakutkan sebenarnya.'
                ],
                alibiBersalah: 'Saya sedang menyiram tanaman di taman belakang rumah ketika mendengar teriakan.',
                kontradiksi: 'Pembunuh mengaku sedang menyiram tanaman saat badai petir ‚Äî aktivitas yang mustahil dan tidak masuk akal ketika hujan sudah turun dengan deras!'
            },
            {
                id: 'malam_kering',
                fakta: 'Malam itu langit cerah tanpa hujan sama sekali.',
                faktaPendek: 'malam kering dan cerah',
                setBukti: [
                    { label: 'Laporan Cuaca', text: 'Langit cerah tercatat. Tidak ada hujan selama 72 jam terakhir.' },
                    { label: 'TKP', text: 'Jejak kaki berdebu ditemukan di teras. Tanah benar-benar kering.' },
                    { label: 'Bukti Fisik', text: 'Jaket tersangka ditemukan basah kuyup di ruang cuci.' }
                ],
                alibiTakBersalah: [
                    'Saya melihat bintang di balkon. Langit sangat indah dan cerah malam itu.',
                    'Saya jalan-jalan sore di taman. Cuaca kering membuatnya menyenangkan.',
                    'Saya duduk di dekat perapian meskipun tidak dingin. Hanya untuk suasana saja.',
                    'Saya menghabiskan malam di teras, menikmati langit malam yang cerah.'
                ],
                alibiBersalah: 'Saya kehujanan saat pulang jalan kaki, makanya saya terlambat sampai dan basah kuyup.',
                kontradiksi: 'Pembunuh mengaku kehujanan, tapi catatan cuaca mengonfirmasi malam itu kering dengan langit cerah. Baju basah mereka menunjukkan mereka sedang mencuci bukti!'
            },
            {
                id: 'alibi_waktu',
                fakta: 'Jam kakek di ruang kerja berhenti tepat pukul 22.47 saat terjatuh.',
                faktaPendek: 'pembunuhan terjadi pukul 22.47',
                setBukti: [
                    { label: 'Jam Rusak', text: 'Jam kakek antik ditemukan terjatuh. Berhenti di pukul 22.47.' },
                    { label: 'Laporan Koroner', text: 'Waktu kematian diperkirakan antara pukul 22.30 - 23.00.' },
                    { label: 'Catatan Telepon', text: 'Panggilan terakhir korban pukul 22.42, hanya berlangsung 30 detik.' }
                ],
                alibiTakBersalah: [
                    'Saya sudah di kamar jam 10 malam. Saya ingat karena saya selalu tidur awal.',
                    'Saya sedang menelepon kakak saya saat itu. Dia bisa konfirmasi teleponnya lebih dari satu jam.',
                    'Saya di bar lokal sampai tengah malam. Pelayan melihat saya di sana.',
                    'Saya menonton berita malam di ruang tamu. Acaranya mulai jam 10 malam.'
                ],
                alibiBersalah: 'Saya meninggalkan rumah jam 9 malam dan baru kembali tengah malam. Saya di bioskop menonton film.',
                kontradiksi: 'Pembunuh mengaku di bioskop dari jam 9 malam sampai tengah malam, tapi catatan teater menunjukkan tidak ada film yang selesai setelah pukul 22.30 malam itu. Mereka punya banyak waktu untuk melakukan pembunuhan pukul 22.47!'
            },
            {
                id: 'ruang_terkunci',
                fakta: 'Ruang kerja terkunci dari dalam. Hanya korban yang punya kuncinya.',
                faktaPendek: 'ruangan terkunci dengan hanya satu kunci',
                setBukti: [
                    { label: 'Analisis Pintu', text: 'Pintu ruang kerja terkunci dari dalam. Tidak ada tanda pembobolan.' },
                    { label: 'Lokasi Kunci', text: 'Satu-satunya kunci ditemukan di saku korban.' },
                    { label: 'Status Jendela', text: 'Semua jendela terkunci dari dalam. Satu kaitnya rusak tapi tetap tertutup.' }
                ],
                alibiTakBersalah: [
                    'Saya tidak pernah masuk ke ruang kerja. Saya bahkan tidak tahu di mana kuncinya disimpan.',
                    'Saya mengetuk pintu ruang kerja tadi tapi tidak ada respons. Saya kira dia sibuk.',
                    'Saya melihat korban masuk ruang kerja dan menguncinya. Itu terakhir kali saya melihatnya.',
                    'Saya diberitahu untuk tidak mengganggunya di ruang kerja. Saya menghormati aturan itu.'
                ],
                alibiBersalah: 'Saya di ruang kerja bersama korban membahas bisnis, tapi saya keluar lewat pintu sebelum sesuatu terjadi.',
                kontradiksi: 'Pembunuh mengaku keluar lewat pintu, tapi pintunya terkunci dari dalam dengan satu-satunya kunci masih di saku korban! Mereka pasti kabur lewat jendela dengan kait rusak, yang tidak mereka sebutkan!'
            },
            {
                id: 'mati_listrik',
                fakta: 'Ada pemadaman listrik total di mansion dari jam 9 malam sampai 11 malam.',
                faktaPendek: 'pemadaman listrik selama dua jam',
                setBukti: [
                    { label: 'Perusahaan Listrik', text: 'Pemadaman dikonfirmasi dari pukul 21.00 - 23.03 karena kegagalan trafo.' },
                    { label: 'TKP', text: 'Lilin-lilin ditemukan menyala di seluruh rumah. Lampu darurat tidak berfungsi.' },
                    { label: 'Bukti Fisik', text: 'Senter dengan sidik jari segar ditemukan di dekat mayat.' }
                ],
                alibiTakBersalah: [
                    'Saya meraba-raba dalam gelap mencari lilin. Mati lampu sangat merepotkan.',
                    'Saya tetap di kamar selama pemadaman. Tidak mau tersandung-sandung dalam gelap.',
                    'Saya pakai ponsel sebagai senter untuk ke dapur mengambil air.',
                    'Saya duduk dengan cahaya lilin di ruang tamu, membaca dengan cahaya redup sampai listrik kembali.'
                ],
                alibiBersalah: 'Saya menonton televisi di ruang tamu sepanjang malam. Dokumenter tentang alam yang sangat menarik.',
                kontradiksi: 'Pembunuh mengaku menonton TV saat listrik padam! Tidak ada listrik berarti tidak ada televisi. Alibi ini benar-benar mustahil!'
            },
            {
                id: 'bukti_luka',
                fakta: 'Korban melawan dengan keras, mencakar wajah dan lengan penyerang.',
                faktaPendek: 'pergulatan keras dengan penyerang',
                setBukti: [
                    { label: 'Kuku Korban', text: 'Jaringan kulit dan darah ditemukan di bawah kuku korban.' },
                    { label: 'TKP', text: 'Tanda-tanda pergulatan hebat. Furnitur terbalik, kaca pecah.' },
                    { label: 'Laporan Medis', text: 'Cakaran akan terlihat dan segar. Kemungkinan di wajah, leher, atau lengan.' }
                ],
                alibiTakBersalah: [
                    'Saya tidak ada di dekat lokasi kejadian. Seperti yang Anda lihat, saya tidak punya luka sama sekali.',
                    'Saya punya kulit sensitif dan mudah memar, tapi saya tidak punya cakaran atau bekas luka.',
                    'Silakan periksa saya. Saya tidak ada yang disembunyikan dan tidak ada luka.',
                    'Saya berhati-hati menghindari konfrontasi. Kekerasan bukan sifat saya.'
                ],
                alibiBersalah: 'Cakaran di wajah dan lengan saya ini dari kucing saya tadi siang. Dia kadang agresif.',
                kontradiksi: 'Pembunuh menyalahkan cakaran pada kucingnya, tapi analisis jaringan di bawah kuku korban cocok dengan golongan darah pembunuh! Korban menandai penyerangnya saat pergulatan!'
            },
            {
                id: 'saksi_mata',
                fakta: 'Saksi mata melihat seseorang berjas merah melarikan diri dari lokasi.',
                faktaPendek: 'saksi melihat pelaku berjas merah',
                setBukti: [
                    { label: 'Kesaksian Saksi', text: 'Tetangga melihat sosok berjas merah lari dari mansion sekitar pukul 22.00.' },
                    { label: 'CCTV Jalanan', text: 'Rekaman menunjukkan bayangan berjas merah menuju gang belakang.' },
                    { label: 'Bukti Fisik', text: 'Sehelai benang merah ditemukan tersangkut di pagar belakang.' }
                ],
                alibiTakBersalah: [
                    'Saya tidak punya jas merah. Anda bisa periksa lemari saya.',
                    'Malam itu saya pakai sweater biru. Banyak yang melihat saya memakainya.',
                    'Saya tidak keluar rumah sama sekali. Jas saya semua ada di lemari.',
                    'Warna favorit saya hitam. Saya tidak pernah pakai warna mencolok seperti merah.'
                ],
                alibiBersalah: 'Saya di rumah sepanjang malam dan tidak keluar sama sekali. Saya bahkan tidak punya pakaian berwarna merah.',
                kontradiksi: 'Pembunuh mengaku tidak punya pakaian merah, tapi saat penggeledahan, jas merah dengan noda darah korban ditemukan tersembunyi di bagasi mobilnya! Jelas bukti yang coba disembunyikan!'
            }
        ];

        const LOKASI = [
            { nama: 'Mansion Keluarga Wijaya', tipe: 'sebuah mansion tua di pinggir kota' },
            { nama: 'Vila Bukit Rindang', tipe: 'vila mewah di kawasan elit' },
            { nama: 'Rumah Tua Hartono', tipe: 'rumah warisan keluarga konglomerat' },
            { nama: 'Istana Mini Soerjoatmodjo', tipe: 'kediaman megah seorang hartawan' },
            { nama: 'Pondok Mewah Cendana', tipe: 'villa peristirahatan keluarga kaya' },
            { nama: 'Rumah Besar Prasetyo', tipe: 'kediaman bangsawan lama' }
        ];

        const KORBAN = [
            { nama: 'Tuan Besar Hendro Wijaya', peran: 'sang patriark kaya raya', emoji: 'üë¥' },
            { nama: 'Nyonya Victoria Hartono', peran: 'pewaris tunggal kekayaan', emoji: 'üë©' },
            { nama: 'Profesor Arman Surya', peran: 'cendekiawan ternama', emoji: 'üßì' },
            { nama: 'Pak Sebastian Gunawan', peran: 'pengusaha sukses', emoji: 'üßî' },
            { nama: 'Bu Agung Eleanor', peran: 'aristokrat berpengaruh', emoji: 'üëµ' },
            { nama: 'Dokter Helena Vance', peran: 'dokter keluarga', emoji: 'üë©‚Äç‚öïÔ∏è' }
        ];

        const KOLAM_TERSANGKA = [
            { nama: 'Margaretha Sari', peran: 'Kepala Pelayan', emoji: 'üßπ', gender: 'wanita' },
            { nama: 'Bambang Susilo', peran: 'Butler Kepercayaan', emoji: 'üé©', gender: 'pria' },
            { nama: 'Clara Permata', peran: 'Keponakan Perempuan', emoji: 'üëß', gender: 'wanita' },
            { nama: 'Joko Hartanto', peran: 'Keponakan Laki-laki', emoji: 'üë®', gender: 'pria' },
            { nama: 'Dr. Marcus Wijanto', peran: 'Dokter Keluarga', emoji: '‚öïÔ∏è', gender: 'pria' },
            { nama: 'Elizabeth Putri', peran: 'Sekretaris Pribadi', emoji: 'üìã', gender: 'wanita' },
            { nama: 'Togar Siahaan', peran: 'Tukang Kebun', emoji: 'üåø', gender: 'pria' },
            { nama: 'Sofia Larasati', peran: 'Pengasuh Anak', emoji: 'üìö', gender: 'wanita' },
            { nama: 'Hendra Kusuma', peran: 'Rekan Bisnis', emoji: 'üíº', gender: 'pria' },
            { nama: 'Isabella Wulandari', peran: 'Mantan Istri', emoji: 'üíî', gender: 'wanita' },
            { nama: 'Rahmat Hidayat', peran: 'Sopir Pribadi', emoji: 'üöó', gender: 'pria' },
            { nama: 'Vivian Anggraeni', peran: 'Kekasih Gelap', emoji: 'üíã', gender: 'wanita' }
        ];

        const WAKTU = [
            'tadi malam sekitar pukul 22.30',
            'di larut malam kemarin',
            'menjelang tengah malam',
            'saat jam makan malam',
            'di dini hari tadi',
            'saat jam menunjukkan pukul sebelas malam'
        ];

        const METODE_PEMBUNUHAN = [
            'ditemukan tercekik di ruang kerja',
            'ditemukan keracunan di meja makan',
            'ditemukan ditikam di perpustakaan',
            'ditemukan dipukul benda tumpul di konservatori',
            'ditemukan tertembak di kamar tidur utama',
            'ditemukan terjatuh dari balkon'
        ];

        // ==================== STATE PERMAINAN ====================
        
        let statePermainan = {
            kasusSaatIni: 1,
            reputasi: 100,
            kasusTerpecahkan: 0,
            pelakuSaatIni: null,
            kontradiksiSaatIni: null,
            tersangka: []
        };

        // ==================== FUNGSI PERMAINAN ====================

        function acakArray(array) {
            const teracak = [...array];
            for (let i = teracak.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [teracak[i], teracak[j]] = [teracak[j], teracak[i]];
            }
            return teracak;
        }

        function ambilItemAcak(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function generateKasus() {
            // Pilih elemen acak
            const lokasi = ambilItemAcak(LOKASI);
            const korban = ambilItemAcak(KORBAN);
            const waktu = ambilItemAcak(WAKTU);
            const metode = ambilItemAcak(METODE_PEMBUNUHAN);
            const template = ambilItemAcak(TEMPLATE_KONTRADIKSI);

            // Pilih 3 tersangka acak
            const tersangkaTeracak = acakArray(KOLAM_TERSANGKA);
            const tersangkaTerpilih = tersangkaTeracak.slice(0, 3);
            
            // Pilih pelaku secara acak (0, 1, atau 2)
            const indexPelaku = Math.floor(Math.random() * 3);
            
            // Siapkan alibi
            const alibiTakBersalahTersedia = acakArray([...template.alibiTakBersalah]);
            
            const tersangka = tersangkaTerpilih.map((t, index) => {
                const adalahPelaku = index === indexPelaku;
                return {
                    ...t,
                    adalahPelaku,
                    kesaksian: adalahPelaku ? template.alibiBersalah : alibiTakBersalahTersedia.pop()
                };
            });

            // Simpan di state permainan
            statePermainan.pelakuSaatIni = indexPelaku;
            statePermainan.kontradiksiSaatIni = template.kontradiksi;
            statePermainan.tersangka = tersangka;
            statePermainan.templateSaatIni = template;

            // Generate narasi
            const narasi = `
                <p style="margin-bottom: 15px;">
                    Investigasi dimulai di <span class="highlight">${lokasi.nama}</span>, 
                    ${lokasi.tipe} yang diselimuti misteri dan rahasia kelam.
                </p>
                <p style="margin-bottom: 15px;">
                    <span class="highlight">${korban.nama}</span>, ${korban.peran}, 
                    ${metode} ${waktu}.
                </p>
                <p>
                    Fakta kunci kasus ini: <strong>${template.fakta}</strong>
                    Tiga orang berada di lokasi saat kejadian. Salah satu dari mereka berbohong.
                </p>
            `;

            return {
                lokasi,
                korban,
                waktu,
                metode,
                template,
                tersangka,
                narasi
            };
        }

        function renderKasus(dataKasus) {
            // Update judul kasus
            document.getElementById('caseTitle').textContent = `KASUS #${String(statePermainan.kasusSaatIni).padStart(3, '0')}`;
            
            // Render narasi dengan fade-in
            const elNarasi = document.getElementById('narrationText');
            elNarasi.innerHTML = dataKasus.narasi;
            elNarasi.classList.remove('fade-in');
            void elNarasi.offsetWidth; // Trigger reflow
            elNarasi.classList.add('fade-in');

            // Render bukti
            const daftarBukti = document.getElementById('evidenceList');
            daftarBukti.innerHTML = '';
            dataKasus.template.setBukti.forEach((bukti, index) => {
                const li = document.createElement('li');
                li.className = 'evidence-item';
                li.style.animationDelay = `${index * 0.15}s`;
                li.innerHTML = `
                    <div class="evidence-label">${bukti.label}</div>
                    <div class="evidence-text">${bukti.text}</div>
                `;
                daftarBukti.appendChild(li);
            });

            // Render tersangka
            const gridTersangka = document.getElementById('suspectsGrid');
            gridTersangka.innerHTML = '';
            dataKasus.tersangka.forEach((tersangka, index) => {
                const kartu = document.createElement('div');
                kartu.className = 'suspect-card';
                kartu.dataset.index = index;
                kartu.innerHTML = `
                    <div class="suspect-header">
                        <div class="suspect-avatar">${tersangka.emoji}</div>
                        <div class="suspect-name">${tersangka.nama}</div>
                        <div class="suspect-role">${tersangka.peran}</div>
                    </div>
                    <div class="suspect-testimony">
                        <div class="testimony-label">Kesaksian</div>
                        <p class="testimony-text">${tersangka.kesaksian}</p>
                    </div>
                    <button class="accuse-btn" onclick="tuduhTersangka(${index})">
                        Tuduh Tersangka Ini
                    </button>
                `;
                gridTersangka.appendChild(kartu);
            });

            // Update statistik
            updateStatistik();
        }

        function updateStatistik() {
            document.getElementById('caseNumber').textContent = statePermainan.kasusSaatIni;
            document.getElementById('reputation').textContent = statePermainan.reputasi;
            document.getElementById('casesSolved').textContent = statePermainan.kasusTerpecahkan;
        }

        function tuduhTersangka(index) {
            const kartu = document.querySelectorAll('.suspect-card');
            const kartuTerpilih = kartu[index];
            
            // Tambah animasi tertuduh
            kartuTerpilih.classList.add('accused');
            
            setTimeout(() => {
                if (index === statePermainan.pelakuSaatIni) {
                    // Tuduhan benar
                    kartuTerpilih.classList.remove('accused');
                    kartuTerpilih.classList.add('correct');
                    statePermainan.kasusTerpecahkan++;
                    tampilkanModalHasil(true);
                } else {
                    // Tuduhan salah
                    kartuTerpilih.classList.remove('accused');
                    kartuTerpilih.classList.add('wrong');
                    statePermainan.reputasi -= 25;
                    
                    if (statePermainan.reputasi <= 0) {
                        setTimeout(() => tampilkanGameOver(), 1000);
                    } else {
                        tampilkanModalHasil(false, index);
                    }
                }
            }, 600);
        }

        function tampilkanModalHasil(benar, indexSalah = null) {
            const modal = document.getElementById('resultModal');
            const ikon = document.getElementById('modalIcon');
            const judul = document.getElementById('modalTitle');
            const teks = document.getElementById('modalText');
            const penjelasan = document.getElementById('explanationText');
            const tombol = document.getElementById('modalBtn');

            if (benar) {
                ikon.textContent = 'üéØ';
                judul.textContent = 'KASUS TERPECAHKAN!';
                judul.className = 'modal-title success';
                penjelasan.textContent = statePermainan.kontradiksiSaatIni;
                teks.textContent = `Kerja detektif yang luar biasa! Pembunuh telah ditangkap. Reputasi Anda tetap terjaga.`;
                tombol.textContent = 'Kasus Berikutnya';
                tombol.onclick = () => {
                    tutupModal();
                    kasusBerikutnya();
                };
            } else {
                const tersangkaSalah = statePermainan.tersangka[indexSalah];
                const pelakuAsli = statePermainan.tersangka[statePermainan.pelakuSaatIni];
                
                ikon.textContent = '‚ùå';
                judul.textContent = 'TUDUHAN SALAH';
                judul.className = 'modal-title failure';
                penjelasan.textContent = `Alibi ${tersangkaSalah.nama} dapat diverifikasi. Perhatikan lebih teliti bukti-bukti dan temukan siapa yang ceritanya benar-benar bertentangan dengan fakta.`;
                teks.textContent = `Reputasi Anda berkurang 25 poin. Reputasi saat ini: ${statePermainan.reputasi}. Coba lagi!`;
                tombol.textContent = 'Lanjutkan Investigasi';
                tombol.onclick = () => {
                    tutupModal();
                    // Reset state kartu
                    document.querySelectorAll('.suspect-card').forEach(kartu => {
                        kartu.classList.remove('wrong', 'correct', 'accused');
                    });
                };
            }

            modal.classList.add('active');
        }

        function tutupModal() {
            document.getElementById('resultModal').classList.remove('active');
        }

        function kasusBerikutnya() {
            statePermainan.kasusSaatIni++;
            const dataKasus = generateKasus();
            
            // Reset state kartu
            document.querySelectorAll('.suspect-card').forEach(kartu => {
                kartu.classList.remove('wrong', 'correct', 'accused');
            });
            
            renderKasus(dataKasus);
        }

        function lewatiKasus() {
            statePermainan.reputasi -= 20;
            if (statePermainan.reputasi <= 0) {
                tampilkanGameOver();
            } else {
                statePermainan.kasusSaatIni++;
                const dataKasus = generateKasus();
                renderKasus(dataKasus);
            }
        }

        function tampilkanGameOver() {
            const layarGameOver = document.getElementById('gameOverScreen');
            const statistikAkhir = document.getElementById('finalStats');
            
            let peringkat = '';
            if (statePermainan.kasusTerpecahkan >= 5) {
                peringkat = '‚òÖ Detektif Legendaris ‚òÖ';
            } else if (statePermainan.kasusTerpecahkan >= 3) {
                peringkat = 'Investigator Kompeten';
            } else {
                peringkat = 'Detektif Pemula';
            }
            
            statistikAkhir.innerHTML = `
                <p>Kasus Diinvestigasi: ${statePermainan.kasusSaatIni}</p>
                <p>Kasus Terpecahkan: ${statePermainan.kasusTerpecahkan}</p>
                <p>Reputasi Akhir: ${Math.max(0, statePermainan.reputasi)}</p>
                <p style="margin-top: 20px; color: ${statePermainan.kasusTerpecahkan >= 5 ? 'var(--gold)' : 'var(--blood-red)'}">
                    ${peringkat}
                </p>
            `;
            
            layarGameOver.classList.add('active');
        }

        function mulaiUlang() {
            statePermainan = {
                kasusSaatIni: 1,
                reputasi: 100,
                kasusTerpecahkan: 0,
                pelakuSaatIni: null,
                kontradiksiSaatIni: null,
                tersangka: []
            };
            
            document.getElementById('gameOverScreen').classList.remove('active');
            const dataKasus = generateKasus();
            renderKasus(dataKasus);
        }

        function mulaiPermainan() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameContainer').style.display = 'block';
            
            const dataKasus = generateKasus();
            renderKasus(dataKasus);
        }

        // ==================== INISIALISASI ====================
        
        document.addEventListener('DOMContentLoaded', () => {
            console.log('PARADOKS ALIBI - Siap dimainkan');
        });
    </script>
</body>
</html>
